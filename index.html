<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Docker-archlinux-ssh-hpn by yantis</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Docker-archlinux-ssh-hpn</h1>
      <h2 class="project-tagline">Docker Arch Linux High Performance SSH/SCP - HPN-SSH Client / Server Container</h2>
      <a href="https://github.com/yantis/docker-archlinux-ssh-hpn" class="btn">View on GitHub</a>
      <a href="https://github.com/yantis/docker-archlinux-ssh-hpn/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/yantis/docker-archlinux-ssh-hpn/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="archlinux-ssh-hpn" class="anchor" href="#archlinux-ssh-hpn" aria-hidden="true"><span class="octicon octicon-link"></span></a>archlinux-ssh-hpn</h1>

<p>On Docker hub <a href="https://registry.hub.docker.com/u/yantis/archlinux-small-ssh-hpn/">archlinux-small-ssh-hpn</a>
on Github <a href="https://github.com/yantis/docker-archlinux-ssh-hpn">docker-archlinux-ssh-hpn</a></p>

<p><a href="http://www.psc.edu/index.php/hpn-ssh">High Performance SSH/SCP - HPN-SSH</a>
OpenSSH_6.8p1-hpn14v5, OpenSSL 1.0.2a 19 Mar 2015</p>

<p>This small layer adds 6MB to the <a href="https://registry.hub.docker.com/u/yantis/archlinux-small/">archlinux-small</a> layer.</p>

<p>This is both the server and the client. With the default being the server running as an <a href="http://skarnet.org/software/s6/index.html">S6 service</a></p>

<p>There are some nice speedup improvements to this. One of the nice features of this is the NONE cipher
for when there isn't at TTY allocated. ie: SCP. (authentication is still encrypted but your data 
isn't. So keep that in mind (ie: It is fine for images and video but not OK for your bitcoin wallet).</p>

<p>On the client you would use it as:
ssh user@hostname oNoneEnabled=true -oNoneSwitch=yes</p>

<p>You can also use one of the multithread ciphers for when a TTY is allocated like:
ssh user@hostname -oCipher=aes128-ctr</p>

<h3>
<a id="docker-images-structure" class="anchor" href="#docker-images-structure" aria-hidden="true"><span class="octicon octicon-link"></span></a>Docker Images Structure</h3>

<blockquote>
<p><a href="https://github.com/yantis/docker-archlinux-tiny">yantis/archlinux-tiny</a></p>

<blockquote>
<p><a href="https://github.com/yantis/docker-archlinux-small">yantis/archlinux-small</a></p>

<blockquote>
<p><a href="https://github.com/yantis/docker-archlinux-ssh-hpn">yantis/archlinux-small-ssh-hpn</a></p>

<blockquote>
<p><a href="https://github.com/yantis/docker-ssh-hpn-x">yantis/ssh-hpn-x</a></p>

<blockquote>
<p><a href="https://github.com/yantis/docker-dynamic-video">yantis/dynamic-video</a></p>

<blockquote>
<p><a href="https://github.com/yantis/docker-virtualgl">yantis/virtualgl</a></p>

<blockquote>
<p><a href="https://github.com/yantis/docker-wine">yantis/wine</a></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>

<h2>
<a id="server" class="anchor" href="#server" aria-hidden="true"><span class="octicon octicon-link"></span></a>Server</h2>

<p>The server follows these docker conventions:</p>

<ul>
<li>
<code>-it</code> will run an interactive session that can be terminated with CTRL+C.</li>
<li>
<code>--rm</code> will run a temporary session that will make sure to remove the container on exit.</li>
<li>
<code>-v $HOME/.ssh/authorized_keys:/authorized_keys:ro</code> (optionally provide your keys authorized keys)</li>
<li>
<code>-p 49158:22</code> port to map to port 22.</li>
</ul>

<p>If you have authorized public keys it will use them for both the root/docker users. I like using it
this way for example if I throw this up on AWS and I just use the same keys both both the primary
sshd server and the docker containers.</p>

<p>If you pass it keys it will disable password logging in. If you don't pass it authorized keys it
will enable the login via password.
The default user/password is docker/docker</p>

<div class="highlight highlight-bash"><pre>docker run \
           -ti \
           --rm \
           -v <span class="pl-smi">$HOME</span>/.ssh/authorized_keys:/authorized_keys:ro \
           -h docker \
           -p 49158:22 \
           yantis/archlinux-small-ssh-hpn</pre></div>

<h2>
<a id="client" class="anchor" href="#client" aria-hidden="true"><span class="octicon octicon-link"></span></a>Client</h2>

<p>To use the client you can just run it as so to get a shell (or /bin/bash if you prefer)</p>

<div class="highlight highlight-bash"><pre>docker run -ti --rm yantis/archlinux-small-ssh-hpn /bin/zsh</pre></div>

<p>This example uploads a file to your server.</p>

<div class="highlight highlight-bash"><pre>docker run -ti --rm -v <span class="pl-k">~</span>/Downloads:/Downloads yantis/archlinux-small-ssh-hpn scp -P 49158 -oNoneEnabled=<span class="pl-c1">true</span> -oNoneSwitch=yes /Downloads/alpine-3.1.3-x86_64.iso docker@monster:<span class="pl-k">~</span>/ </pre></div>

<p>This example uses a private key to connect to your server and runs xeyes.</p>

<div class="highlight highlight-bash"><pre>xhost +si:localuser:<span class="pl-s"><span class="pl-pds">$(</span>whoami<span class="pl-pds">)</span></span> <span class="pl-k">&gt;</span>/dev/null

docker run \
           -ti \
           --rm \
           -e DISPLAY \
           -v /tmp/.X11-unix:/tmp/.X11-unix:ro \
           -v <span class="pl-k">~</span>/.ssh/privatekey.pem:/home/docker/.ssh/privatekey.pem:ro \
           -u docker \
           yantis/archlinux-small-ssh-hpn ssh -X -i /home/docker/.ssh/privatekey.pem docker@yourserver -p 49158 -t xeyes</pre></div>

<p>If you look at the below screenshot I ran three tests. First one is normal, second one is the NONE
cipher and the third one was normal to show no caching was going on.
The NONE cipher was twice as fast.
<img src="http://yantis-scripts.s3.amazonaws.com/screenshot_20150408-053726.jpg" alt=""></p>

<p>If you have AWS and If this is something you want to play with check out the <a href="https://github.com/yantis/docker-archlinux-ssh-hpn/blob/master/launch.sh">launch.sh</a>
script on github. It will create a new AWS ec2 instance, install docker and launch the container then log you in. It should work with the AWS free tier.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/yantis/docker-archlinux-ssh-hpn">Docker-archlinux-ssh-hpn</a> is maintained by <a href="https://github.com/yantis">yantis</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-61848149-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>

